# script

m: xxx
r: yyy

https://www.youtube.com/watch?v=PPZ5XiTr_lI  
パステルハウス

#### 1

m 
みなさんこんにちは  
本日はプログラムの説明をしていこうと思います　

#### 2

m 今回のスライドでは、こちらのリポジトリの内容を説明します。  
r 最近流行りのgithubにソースコードがあるのですね。  
m 概要欄にリポジトリへのリンクを貼っておきますのでご参考ください。  

#### 3

m こちらが目次となります。  
m まずプログラムの概要を説明した後、  
m ルールやプログラムの全体像、サンプルプログラムについて説明します。  
r 環境構築についても触れようと思いますので、  
r プログラムを動かすイメージに少しでも繋がれば嬉しいです。  

#### 4

m 本プログラムの概要です。  
m 本プログラムは、プログラミング教育でおなじみのテトリス風のゲームを題材にしています。  

r: 昔ファミコンとかで遊んだことがある人も多い気がします。  
　　ご存知の通りブロックを動かして得点を競うパズルゲームですね。    

m ゲーム自体はプログラミング言語であるPythonを使って用意しました。  
m テトリスのブロックを動かす部分をカスタマイズして独自のアルゴリズムを作り込めるような構造にしています。  

#### 5

m 実際に動かしている様子がこちらです  
r あれ、動いてませんね  
m 動作上で動画を動かせなかったのですが、雰囲気伝わると思います  
  
m 同じブロックが落ちてきてもアルゴリズムによって置き方が異なるため、  
m それが盤面の違いに表れています。  
r AIに関しても学習のさせかたによって性能が変わるので、それが置き方に違いに繋がっています      
m プログラムやアルゴリズムを理解する事はもちろんですが、  
m どうすればつよいアルゴリズムを作れるのかも興味深いですね。    

#### 6

m ゲームのルールです  
m 一般的なやり方同様、一定の大きさのフィールドにブロックを定期的に置いていき、獲得スコアを競います。  
m 一列以上揃ったら消した列の数に応じた得点を獲得し、180秒以内の獲得スコアを競います  
m ブロックが上部まで詰まったらフィールドがリセットされ、スコアが減点されます。  
r とにかく4列消しをしていけばいいっぽい感じですかね  
m いくつか難易度があり、難易度が高いほど4列消しがやりづらくなっています、次ページで説明します  


#### 7

m ゲームの難易度設定についてです  
m ゲームの難易度は４段階あり、レベル１が易しくて、レベルが上がるほど難易度が高いです。  
m 難易度はプログラムの実行時にオプションで指定できるようにしています。  
r レベルが変わると具体的に何が変わるのでしょうか  
m レベルが変わると、ブロックが出現する順番、フィールドの初期ブロック、フレーム更新頻度が変わります  
m 次のページから詳細を述べていきます。  

#### 8

m まずレベル1についてです  
m レベル1はブロックが出現する順番が固定である事が特徴です  
m フィールドの初期ブロックは存在せず、ブロックが登場する頻度も一定であり、最もシンプルな難易度設定になっています  
r まずはここから考えるとステップアップできそうですね  

#### 9

m level1のブロックの順番固定についてです  
m ブロックは記載の通り7種類あり、それぞれインデックスが付いています  
m レベル1では、インデックスが1から7のものが順番に繰り返し落ちてきます  
r 順番固定であれば、プログラムもある程度固定の実装でもスコア狙えるかもしれませんね  

#### 10

次にレベル2についてです  
m レベル2は、レベル1と異なりブロックが出現する順番がランダムである事が特徴です  
r 他の条件は同じですが、プログラムの柔軟性がより求められる感じですね  
r ファミコンとかで遊んでたルールに近いと思うので、いつも頭の中で考えていたことを実装してみるといいかもしれませんね

#### 10

レベル3についてです
m レベル3は、ブロックが出現する順番がランダムである事に加えて、
m フィールドにブロックがあることに加えてが特徴です  
r なんか邪魔そうなものが置いてありますね
m 最初から10段分のお邪魔ブロックがあり、ちょっと難易度が高くなっています  
r 全部消したら全消しボーナス加点があると聞いたので、何か工夫したいですね

#### 11

そして、レベル4についてです  
m レベル4、レベル3の条件に加えてブロックが落ちるスピードがとてもはやい！ことが特徴です  
r どれくらい速いのかな  
m ものすごく速いです、１ミリ秒くらいなので目にも留まらぬ速さです  
r 処理高速化や処理ボトルネック解析など、つよめのノウハウが要りそう感がありますね    

#### 12

m その他にも、AI部門と題して、  
m 強化学習などを利用したプログラム同士で戦う部門や  
m 芸術部門と題して、  
m ブロックでartを作成して芸術性を競うにぎやかし部門向けに    
m サンプルコードを用意しているので興味ありましたらリポジトリの説明を読んでみてください  
r どこかの展示会に出展できそう感がありますね   

#### 13

ここからはプログラムの全体構成について説明します  


#### 14

ブロック操作用プログラムとボード情報についてです  

#### 15

フィールド情報についてです  

#### 16

フィールドに格納されているデータについてです

#### 17

ブロック情報についてです

#### 18

ブロック操作の基準点についてです

#### 19

ブロック出現時の初期位置についてです

#### 20

次の動作決定用データについてです
４つの情報を出力する

#### 21

ホールド機能
ブロックを１個保持できる
既にブロックをホールドしている場合は、現在のブロックと交換する

#### 22

以上がプログラムの全体構成についてでした、  
ここからはサンプルプログラムのソースコードについて説明します
目的：コード理解の補助  


#### 23

サンプルプログラムは大きく３つ用意しています。

random
簡易的に探索処理を実装してみたもの(python start.py -m sampleで動くもの)
機械学習


#### 24

random
ブロックをランダムに置くだけのサンプルプログラム　コード
以下を完全にランダムに置く
x座標
回転回数

組み合わせ
x座標：最大10通り
回転回数：最大4通り
→10×4=40通りから1つ選ぶ
（重複あり、ブロックにより違いあり）

#### 25

簡易的に探索処理を実装してみたもの(python start.py -m sampleで動くもの)　
コード
一般的な探索アルゴリズムでも基本となる
　　以下を簡潔に実装している
1.探索
2.評価

#### 26

探索
現在のブロックの情報（以下）を使って全探索している
現在のブロックが回転できる回数
現在のブロックが移動できるx軸方向の移動量

#### 27

評価
以下を考えた盤面評価を行なっている。
仮に現在のブロックを探索候補箇所に置いた時、消せるブロックが多いほど良い
同様に、穴ぼこや孤立したブロックが少ないほど良い
同様に、高さにばらつきが少ないほど良い

#### 28

現状
例）盤面に穴が残ることがかなり多い
　　なぜ？
課題
数手先読み探索
サンプルプログラムでは探索時に現在のブロックしか考慮できていない
次のブロック以降を考慮する方が良いはず
盤面評価の改良
サンプルプログラムでは目先の１ブロックを消す事を優先している。
サンプルプログラムの手法では盤面に穴が残ることがまだまだ多い。
最適解を人が考える必要がある
AIのように自ら学習する方が楽に最適解を得られる可能性がある。

#### 29

機械学習
深層強化学習という方法を使っています
こちらを参照
解説記事も載っているのでご参照ください、  
つよいAIのノウハウは共有して皆でつよくなっていけるといいですね  

#### 30

参考：環境構築

#### 31

プログラムの説明は以上です、
ご視聴ありがとうございました！


